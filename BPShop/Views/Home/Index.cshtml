@using BPShop.Enities
@model List<BPShop.Enities.Product>

@{
    ViewBag.Title = "Главная";
    Layout = null;
    string isVisible = ViewBag.IsHaveCart ? "" : "none";
}
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Интернет-магазин цветов, шариков и мягких игрушек. Широкий выбор товаров с доставкой.">
    <meta name="keywords" content="цветы, шарики, мягкие игрушки, интернет-магазин, доставка">
    <title>Купить цветы, шарики, мягкие игрушки – Интернет-магазин BPShop Без повода. Цветы без повода</title>
    <link href="~/Content/imgs/miniLogo.ico" rel="icon" />
    <!-- Дополнительные мета-теги и стили -->
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
</head>
<body>
    <div class="bg-loader">
        <div class="loader"></div>
    </div>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="header-content">
                <div class="header-logo">
                    <a href="@Url.Action("Index")">
                        <img src="~/Content/imgs/BPLogo_black.png" alt="Alternate Text" />
                    </a>
                    <p>
                        "Без повода" - ваш идеальный онлайн магазин для ярких букетов цветов.
                        У нас вы найдете свежие и красочные композиции, идеально подходящие для подарка без повода.
                        Подарите радость и красоту близким с нашими цветами.
                    </p>
                    <a href="tel:77476322370" style="color: #d26b57; font-size: 20px;"><strong> +7 (747) 632 23 70</strong></a>
                    <a href="mailto:bez.povoda.almaty@gmail.com" style="color: #000; font-weight: bold">bez.povoda.almaty@gmail.com</a>
                </div>

                <div class="slider-block">
                    <div class="slider">
                        <div class="slide"><img src="~/Content/imgs/flowers1.jpg" alt="Изображение 1"></div>
                        <div class="slide"><img src="~/Content/imgs/flowers2.jpg" alt="Изображение 2"></div>
                        <div class="slide"><img src="~/Content/imgs/flowers3.jpg" alt="Изображение 3"></div>
                        <div class="slide"><img src="~/Content/imgs/flowers4.jpg" alt="Изображение 4"></div>
                    </div>
                </div>
            </div>
            <div class="navbar-items">
                <div class="dropdown-navbar-items">
                    <button class="menu-button">Разное ▼</button>
                    <div class="menu-list">
                        <ul>
                            <li>@Html.ActionLink("Шары", "Products", "Home", new { productType = (int)ProductType.Ballons }, null)</li>
                            <li>@Html.ActionLink("Мягкие игрушки", "Products", "Home", new { productType = (int)ProductType.Toys }, null)</li>
                        </ul>
                    </div>
                </div>

                <div class="dropdown-navbar-items">
                    <button class="menu-button">Букеты ▼</button>
                    <div class="menu-list">
                        <ul>
                            <li>@Html.ActionLink("Моно Букеты", "Products", "Home", new { productType = (int)ProductType.MonoBouquet }, null)</li>
                            <li>@Html.ActionLink("Букеты в коробке", "Products", "Home", new { productType = (int)ProductType.BoxFlowers }, null)</li>
                            <li>@Html.ActionLink("Евро Букеты", "Products", "Home", new { productType = (int)ProductType.EvroBouquet }, null)</li>
                        </ul>
                    </div>
                </div>

                <div class="dropdown-navbar-items">
                    <button class="menu-button">Цветы ▼</button>
                    <div class="long-menu-list">
                        <ul class="long-item">
                            <li>@Html.ActionLink("Розы", "Products", "Home", new { flowersType = (int)FlowersType.Roses }, null)</li>
                            <li>@Html.ActionLink("Пионы", "Products", "Home", new { flowersType = (int)FlowersType.Peonies }, null)</li>
                            <li>@Html.ActionLink("Тюльпаны", "Products", "Home", new { flowersType = (int)FlowersType.Tulips }, null)</li>
                            <li>@Html.ActionLink("Гортензии", "Products", "Home", new { flowersType = (int)FlowersType.Hydrangeas }, null)</li>
                            <li>@Html.ActionLink("Пионовидные ", "Products", "Home", new { flowersType = (int)FlowersType.PeonyRoses }, null)</li>
                            <li>@Html.ActionLink("Кустовые ", "Products", "Home", new { flowersType = (int)FlowersType.ShrubRoses }, null)</li>
                            <li>@Html.ActionLink("Альстромерии", "Products", "Home", new { flowersType = (int)FlowersType.Alstroemeria }, null)</li>
                            <li>@Html.ActionLink("Гвоздики", "Products", "Home", new { flowersType = (int)FlowersType.Carnations }, null)</li>
                            <li>@Html.ActionLink("Георгины", "Products", "Home", new { flowersType = (int)FlowersType.Dahlias }, null)</li>
                            <li>@Html.ActionLink("Герберы", "Products", "Home", new { flowersType = (int)FlowersType.Gerberas }, null)</li>
                            <li>@Html.ActionLink("Гипсафилы", "Products", "Home", new { flowersType = (int)FlowersType.Gypsaphila }, null)</li>
                            <li>@Html.ActionLink("Каллы", "Products", "Home", new { flowersType = (int)FlowersType.Calla }, null)</li>
                            <li>@Html.ActionLink("Ирисы", "Products", "Home", new { flowersType = (int)FlowersType.Irises }, null)</li>
                            <li>@Html.ActionLink("Ландыши", "Products", "Home", new { flowersType = (int)FlowersType.ValleyLilies }, null)</li>
                            <li>@Html.ActionLink("Лилии", "Products", "Home", new { flowersType = (int)FlowersType.Lilies }, null)</li>
                            <li>@Html.ActionLink("Орхидеи", "Products", "Home", new { flowersType = (int)FlowersType.Orchids }, null)</li>
                            <li>@Html.ActionLink("Подсолнухи", "Products", "Home", new { flowersType = (int)FlowersType.Sunflowers }, null)</li>
                            <li>@Html.ActionLink("Ранункулюсы", "Products", "Home", new { flowersType = (int)FlowersType.Ranunculus }, null)</li>
                            <li>@Html.ActionLink("Ромашки", "Products", "Home", new { flowersType = (int)FlowersType.Daisies }, null)</li>
                            <li>@Html.ActionLink("Сирень", "Products", "Home", new { flowersType = (int)FlowersType.Lilac }, null)</li>
                            <li>@Html.ActionLink("Сухоцветы", "Products", "Home", new { flowersType = (int)FlowersType.DriedFlowers }, null)</li>
                            <li>@Html.ActionLink("Хризантемы", "Products", "Home", new { flowersType = (int)FlowersType.Chrysanthemums }, null)</li>
                            <li>@Html.ActionLink("Антуриумы", "Products", "Home", new { flowersType = (int)FlowersType.Anthuriums }, null)</li>
                            <li>@Html.ActionLink("Амариллисы", "Products", "Home", new { flowersType = (int)FlowersType.Amaryllis }, null)</li>
                            <li>@Html.ActionLink("Гладиолусы", "Products", "Home", new { flowersType = (int)FlowersType.Gladioli }, null)</li>
                            <li>@Html.ActionLink("Лизиантусы ", "Products", "Home", new { flowersType = (int)FlowersType.Lisianthus }, null)</li>
                        </ul>
                    </div>
                </div>

                <div class="dropdown-navbar-items">
                    <button class="menu-button">Меню ▼</button>
                    <div class="menu-list">
                        <ul>
                            <li>@Html.ActionLink("Главная", "Index", "Home")</li>
                            <li>@Html.ActionLink("О нас", "About", "Home")</li>
                            <li>@Html.ActionLink("Контакты", "Contact", "Home")</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="burger-menu">
                <input id="burger-toggle" type="checkbox" />
                <label class="burger-button" for="burger-toggle">
                    <span></span>
                </label>

                <div class="burger-dropdown-navbar-items">
                    <button class="burger-menu-button" id="raznoe-button">Разное ▼</button>
                    <div class="burger-menu-list" id="raznoe-list">
                        <ul>
                            <li>@Html.ActionLink("Шары", "Products", "Home", new { productType = (int)ProductType.Ballons }, null)</li>
                            <li>@Html.ActionLink("Мягкие игрушки", "Products", "Home", new { productType = (int)ProductType.Toys }, null)</li>
                        </ul>
                    </div>
                    <button class="burger-menu-button" id="bukety-button">Букеты ▼</button>
                    <div class="burger-menu-list" id="bukety-list">
                        <ul>
                            <li>@Html.ActionLink("Моно Букеты", "Products", "Home", new { productType = (int)ProductType.MonoBouquet }, null)</li>
                            <li>@Html.ActionLink("Букеты в коробке", "Products", "Home", new { productType = (int)ProductType.BoxFlowers }, null)</li>
                            <li>@Html.ActionLink("Евро Букеты", "Products", "Home", new { productType = (int)ProductType.EvroBouquet }, null)</li>
                        </ul>
                    </div>
                    <button class="burger-menu-button" id="cvety-button">Цветы ▼</button>
                    <div class="burger-long-menu-list" id="cvety-list">
                        <ul class="burger-long-item">
                            <li>@Html.ActionLink("Розы", "Products", "Home", new { flowersType = (int)FlowersType.Roses }, null)</li>
                            <li>@Html.ActionLink("Пионы", "Products", "Home", new { flowersType = (int)FlowersType.Peonies }, null)</li>
                            <li>@Html.ActionLink("Тюльпаны", "Products", "Home", new { flowersType = (int)FlowersType.Tulips }, null)</li>
                            <li>@Html.ActionLink("Гортензии", "Products", "Home", new { flowersType = (int)FlowersType.Hydrangeas }, null)</li>
                            <li>@Html.ActionLink("Пионовидные ", "Products", "Home", new { flowersType = (int)FlowersType.PeonyRoses }, null)</li>
                            <li>@Html.ActionLink("Кустовые ", "Products", "Home", new { flowersType = (int)FlowersType.ShrubRoses }, null)</li>
                            <li>@Html.ActionLink("Альстромерии", "Products", "Home", new { flowersType = (int)FlowersType.Alstroemeria }, null)</li>
                            <li>@Html.ActionLink("Гвоздики", "Products", "Home", new { flowersType = (int)FlowersType.Carnations }, null)</li>
                            <li>@Html.ActionLink("Георгины", "Products", "Home", new { flowersType = (int)FlowersType.Dahlias }, null)</li>
                            <li>@Html.ActionLink("Герберы", "Products", "Home", new { flowersType = (int)FlowersType.Gerberas }, null)</li>
                            <li>@Html.ActionLink("Гипсафилы", "Products", "Home", new { flowersType = (int)FlowersType.Gypsaphila }, null)</li>
                            <li>@Html.ActionLink("Каллы", "Products", "Home", new { flowersType = (int)FlowersType.Calla }, null)</li>
                            <li>@Html.ActionLink("Ирисы", "Products", "Home", new { flowersType = (int)FlowersType.Irises }, null)</li>
                            <li>@Html.ActionLink("Ландыши", "Products", "Home", new { flowersType = (int)FlowersType.ValleyLilies }, null)</li>
                            <li>@Html.ActionLink("Лилии", "Products", "Home", new { flowersType = (int)FlowersType.Lilies }, null)</li>
                            <li>@Html.ActionLink("Орхидеи", "Products", "Home", new { flowersType = (int)FlowersType.Orchids }, null)</li>
                            <li>@Html.ActionLink("Подсолнухи", "Products", "Home", new { flowersType = (int)FlowersType.Sunflowers }, null)</li>
                            <li>@Html.ActionLink("Ранункулюсы", "Products", "Home", new { flowersType = (int)FlowersType.Ranunculus }, null)</li>
                            <li>@Html.ActionLink("Ромашки", "Products", "Home", new { flowersType = (int)FlowersType.Daisies }, null)</li>
                            <li>@Html.ActionLink("Сирень", "Products", "Home", new { flowersType = (int)FlowersType.Lilac }, null)</li>
                            <li>@Html.ActionLink("Сухоцветы", "Products", "Home", new { flowersType = (int)FlowersType.DriedFlowers }, null)</li>
                            <li>@Html.ActionLink("Хризантемы", "Products", "Home", new { flowersType = (int)FlowersType.Chrysanthemums }, null)</li>
                            <li>@Html.ActionLink("Антуриумы", "Products", "Home", new { flowersType = (int)FlowersType.Anthuriums }, null)</li>
                            <li>@Html.ActionLink("Амариллисы", "Products", "Home", new { flowersType = (int)FlowersType.Amaryllis }, null)</li>
                            <li>@Html.ActionLink("Гладиолусы", "Products", "Home", new { flowersType = (int)FlowersType.Gladioli }, null)</li>
                            <li>@Html.ActionLink("Лизиантусы ", "Products", "Home", new { flowersType = (int)FlowersType.Lisianthus }, null)</li>
                        </ul>
                    </div>
                    <button class="burger-menu-button" id="menu_button">Меню ▼</button>
                    <div class="burger-menu-list" id="menu_list">
                        <ul>
                            <li>@Html.ActionLink("Главная", "Index", "Home")</li>
                            <li>@Html.ActionLink("О нас", "About", "Home")</li>
                            <li>@Html.ActionLink("Контакты", "Contact", "Home")</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container body-content">

        <div class="cartBtn" onclick="showCart()" style="display: @isVisible">
            <img src="~/Content/imgs/bag.png" alt="Cart" />
            <div id="cartCounter">
                <p id="countValue">@ViewBag.CartCount</p>
            </div>
        </div>

        <div class="notify-block">
        </div>

        <div id="myModal" class="modal">
            <div class="modal-content" id="dialogContent">
            </div>
        </div>

        <div>
            <h2 class="fat-h text-center">Букеты с доставкой в Алматы</h2>
        </div>
        <div class="filter-bar" style="justify-content: right;">
            <div class="search-filter">
                <div class="search-input-div">
                    <input type="text" value="" id="searchInpt" />
                    <svg class="" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" onclick="Search()">
                        <path fill="#757575" d="M85 31.1c-.5-8.7-4.4-16.6-10.9-22.3C67.6 3 59.3 0 50.6.6c-8.7.5-16.7 4.4-22.5 11-11.2
                              12.7-10.7 31.7.6 43.9l-5.3 6.1-2.5-2.2-17.8 20 9 8.1 17.8-20.2-2.1-1.8 5.3-6.1c5.8 4.2 12.6 6.3 19.3 6.3 9 0
                              18-3.7 24.4-10.9 5.9-6.6 8.8-15 8.2-23.7zM72.4 50.8c-9.7 10.9-26.5 11.9-37.6 2.3-10.9-9.8-11.9-26.6-2.3-37.6
                              4.7-5.4 11.3-8.5 18.4-8.9h1.6c6.5 0 12.7 2.4 17.6 6.8 5.3 4.7 8.5 11.1 8.9 18.2.5 7-1.9 13.8-6.6 19.2z"></path>
                    </svg>
                </div>
            </div>
        </div>
        <div class="container-products">
            @foreach (var product in Model)
            {
                <div class="product flip-scale-2-hor-top" onclick="showProduct(@product.ID)">
                    <img src="@product.ImgRef" alt="Товар">
                    <div style="padding: 1rem;" onclick="showProduct(@product.ID)">
                        <h3>@product.Name</h3>
                        <p class="price">Цена: @product.Cost</p>
                        <button class="order-button" id="orderBtn" onclick="orderProduct(this, event, @product.ID)">Заказать</button>
                    </div>
                </div>
            }
        </div>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.js"></script>


        <hr />
        <footer>
            <div class="main-footer">
                <div>
                    <div class="footer-logo">
                        <img src="~/Content/imgs/BPLogo_black.png" alt="Alternate Text" />
                    </div>
                    <p>&copy; @DateTime.Now.Year - ТОО "БЕЗ ПОВОДА"</p>
                </div>
                <div class="flex f-column">
                    <h3>Главная</h3>
                    @Html.ActionLink("Каталог", "Products", "Home")
                </div>
                <div class="flex f-column">
                    <h3>Информация</h3>
                    <a href="#">Оплата</a>
                </div>
                <div class="flex f-column">
                    <h3>КОНТАКТЫ</h3>
                    @Html.ActionLink("Контакты магазина", "Contact", "Home")
                    @Html.ActionLink("О нас", "About", "Home")
                </div>
            </div>
            <script>

                var modal = document.getElementById('myModal');
                function showProduct(id) {
                        showLoader();
                        window.onclick = function (event) {
                            if (event.target == modal) {
                                modal.style.display = 'none';
                            }
                        };

                    $.get('@Url.Action("ShowProduct")' + '?Id=' + id,
                    function (data) {
                        hideLoader();
                        $('#dialogContent').html(data);
                        modal.style.display = 'block';

                        var span = document.getElementsByClassName('close')[0];
                        span.onclick = function () {
                            modal.style.display = 'none';
                        };
                    })
                    .fail(function () {
                        hideLoader();
                        alert("Не удалось открыть информацию о продукте");
                        return false;
                    })
                    .done(function () {
                        hideLoader();
                        return true;
                    });
                }

                function showCart() {
                    showLoader();
                    window.onclick = function (event) {
                        if (event.target == modal) {
                            modal.style.display = 'none';
                        }
                    };

                    $.get('@Url.Action("Cart")',
                        function (data) {
                            hideLoader();
                            $('#dialogContent').html(data);
                            modal.style.display = 'block';

                            var span = document.getElementsByClassName('close')[0];
                            span.onclick = function () {
                                modal.style.display = 'none';
                            };
                        })
                        .fail(function () {
                            hideLoader();
                            alert("Не удалось открыть корзину");
                            return false;
                        })
                        .done(function () {
                            hideLoader();
                            return true;
                        });
                }

                function orderProduct(button, event, id, withCounter) {
                    showLoader();
                    var mainElement = document.querySelector('.notify-block');
                    var newDiv = document.createElement('div');
                    var quantity = withCounter ? $('#quantity_' + id).val() : 1 ;

                    setTimeout(function () {
                        newDiv.remove();
                    }, 2000);

                    if (withCounter) {
                        var action = '@Url.Action("AddToCart")' + '?productId=' + id + '&quantity=' + quantity;
                    }
                    else {
                        var action = '@Url.Action("AddToCart")' + '?productId=' + id;
                    }

                    $.get(action,
                        function (data) {
                            hideLoader();
                            if (data == -100) {
                                newDiv.innerHTML = `
                                <div class="notify-item red">
                                    Достигнут лимит в корзине
                                </div >`;
                                mainElement.prepend(newDiv);
                            }
                            else {
                                $('.cartBtn').show();
                                $("#countValue").text(parseInt($("#countValue").text()) + parseInt(quantity));
                                newDiv.innerHTML = `
                                <div class="notify-item">
                                    Заказ добавлен
                                </div >`;
                                mainElement.prepend(newDiv);
                            }
                        })
                        .fail(function () {
                            hideLoader();
                            alert("Ошибка при добавлении в корзину");
                            return false;
                        })
                        .done(function () {
                            hideLoader();
                            return true;
                        });
                    event.stopPropagation();
                }
            </script>
        </footer>
    </div>
    @Scripts.Render("~/Content/Site.js")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
</body>
</html>
